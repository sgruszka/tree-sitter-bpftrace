============================================
Action block with two probes 
============================================

tracepoint:syscalls:sys_enter_open,
tracepoint:syscalls:sys_enter_openat {
	printf("%-6d %-16s %s\n", pid, comm, str(args.filename));
}

---

(source_file
  (action_block
    (probes_list
      (probe
        provider: (tracepoint_provider)
        subsys: (wildcard_identifier)
        event: (wildcard_identifier))
      (probe
        provider: (tracepoint_provider)
        subsys: (wildcard_identifier)
        event: (wildcard_identifier)))
    (action
      (expression_statement
        (call_expression
          function: (identifier)
          arguments: (arguments
            (string_literal
              (string_content)
              (escape_sequence))
            (identifier)
            (identifier)
            (call_expression
              function: (identifier)
                arguments: (arguments
                  (field_expression
                    argument: (args_keyword)
                    field: (identifier))))))))))

============================================
Probe with wildcard
============================================

kprobe:*socket* { printf("%s\n", ksym(reg("ip"))) }

---
(source_file
  (action_block
    (probes_list
      (probe
        provider: (kprobe_kretprobe_provider)
        function: (wildcard_identifier)))
    (action
      (expression_statement
        (call_expression
          function: (identifier)
          arguments: (arguments
            (string_literal
              (string_content)
              (escape_sequence))
            (call_expression
              function: (identifier)
              arguments: (arguments
                (call_expression
                  function: (identifier)
                  arguments: (arguments
                    (string_literal
                      (string_content))))))))))))

============================================
Action block with predicate
============================================

kprobe:vfs_read /comm == "bash"/ {
  printf("read by %s\n", comm);
}

---

(source_file
  (action_block
    (probes_list
      (probe
        provider: (kprobe_kretprobe_provider)
        function: (wildcard_identifier)))
    (predicate
      (binary_expression
        left: (identifier)
        right: (string_literal
          (string_content))))
    (action
      (expression_statement
        (call_expression
          function: (identifier)
          arguments: (arguments
            (string_literal
              (string_content)
              (escape_sequence))
            (identifier)))))))
